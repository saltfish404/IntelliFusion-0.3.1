import os
import csv

# 兼容原有city_map用法，优先加载本地CSV
CITY_CSV_FILE = os.path.join(os.path.dirname(__file__), '../LocationList-master/China-City-List-latest.csv')
city_map = {}
if os.path.exists(CITY_CSV_FILE):
    try:
        with open(CITY_CSV_FILE, 'r', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            for row in reader:
                # 兼容不同字段名，优先用市级
                name = row.get('cityZh') or row.get('city') or row.get('name')
                city_id = row.get('id') or row.get('cityId')
                if name and city_id:
                    city_map[name] = city_id
    except Exception as e:
        print('解析城市CSV失败：', e)
        city_map = {}
# 兜底用常用城市
if not city_map:
    city_map = {
        "北京市": "101010100",
        "上海市": "101020100",
        "广州市": "101280101",
        "深圳市": "101280601",
        "珠海市": "101280701",
        "杭州市": "101210101",
        "南京市": "101190101",
        "苏州市": "101190401",
        "天津市": "101030100",
        "重庆市": "101040100",
        "成都市": "101270101",
        "武汉市": "101200101",
        "西安市": "101110101",
        "郑州市": "101180101",
        "长沙市": "101250101",
        "合肥市": "101220101",
        "福州市": "101230101",
        "厦门市": "101230201",
        "青岛市": "101120201",
        "济南市": "101120101",
        "哈尔滨市": "101050101",
        "长春市": "101060101",
        "沈阳市": "101070101",
        "大连市": "101070201",
        "石家庄市": "101090101",
        "太原市": "101100101",
        "南昌市": "101240101",
        "昆明市": "101290101",
        "贵阳市": "101260101",
        "兰州市": "101160101",
        "海口市": "101310101",
        "三亚市": "101310201",
        "乌鲁木齐市": "101130101",
        "呼和浩特市": "101080101",
        "银川市": "101170101",
        "拉萨市": "101140101",
        "香港": "101320101",
        "澳门": "101330101",
        "台北市": "101340101",
    } 